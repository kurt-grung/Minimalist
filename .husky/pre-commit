#!/usr/bin/env sh
echo "ğŸ” Running pre-commit checks..."

# Run tests for CMS package
echo "ğŸ§ª Running CMS package tests..."
npm run test:cms || {
  echo "âŒ CMS package tests failed. Please fix the errors before committing."
  exit 1
}

# Run tests for demo app
echo "ğŸ§ª Running demo app tests..."
npm run test:demo || {
  echo "âŒ Demo app tests failed. Please fix the errors before committing."
  exit 1
}

# Type check demo app
echo "ğŸ” Running TypeScript type check for demo app..."
cd demo && npx tsc --noEmit || {
  echo "âŒ TypeScript errors found in demo app. Please fix the errors before committing."
  exit 1
}
cd ..

# Build check (CMS package)
echo "ğŸ”¨ Running CMS package build check..."
npm run build:package || {
  echo "âŒ CMS package build failed. Please fix the errors before committing."
  exit 1
}

# Build check (Demo app - this will catch TypeScript errors)
echo "ğŸ”¨ Running demo app build check..."
cd demo && npm run build || {
  echo "âŒ Demo app build failed. Please fix the errors before committing."
  exit 1
}
cd ..

echo "âœ… All pre-commit checks passed!"

